(self["webpackChunk_canva_web"] = self["webpackChunk_canva_web"] || []).push([[97014],{

/***/ 940109:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(905716);self._5f74ec40302898c5a55451c9fbd04240 = self._5f74ec40302898c5a55451c9fbd04240 || {};(function(__c) {var nnc=function(a,b,c){if(a.connection==null)throw Error("Attempted to open a transaction on a closed connection");self.clearTimeout(a.Bea);a.Bea=void 0;const d=a.connection;try{a.fFa++;const e=d.transaction(b,c),f=e.fPb;f.catch(()=>a.dispose()).finally(()=>{a.fFa--;a.fFa<=0&&(a.Bea=self.setTimeout(()=>{a.dispose()},2500))});return{transaction:e,pfb:f}}catch(e){throw a.dispose(),e;}},pnc=async function(a,{wf:b}){const c=b!=null?a.$a?.startSpan("idb_connection_manager.open_idb_connection",b):void 0,
d=onc.open(a.PAa,()=>{a.connection===d&&(a.connection=void 0)}).catch(e=>{a.connection=void 0;c?.setStatus("error");throw e;}).finally(()=>c?.end());return d},qnc=async function(a,b,{wf:c}){const d=c!=null?a.$a?.startSpan("idb_connection_manager.get_connection",c):void 0;try{if(a.connection==null||b?.Hsb)a.connection=pnc(a,{wf:c});let e=await a.connection;e.Sc||(a.connection=pnc(a,{wf:c}),e=await a.connection);return e}catch(e){throw d?.setStatus("error"),e;}finally{d?.end()}},H3=function(a){const b=
Error(a);return c=>{c instanceof Error&&(c.stack==null||c.stack==="")&&(c.stack=b.stack);return c}},rnc=function(a){return new Promise((b,c)=>{const d=()=>{a.removeEventListener("success",e);a.removeEventListener("error",g)},e=()=>{d();b(a.result)},f=H3("idb promisify_request_events error"),g=()=>{d();c(f(a.error))};a.addEventListener("success",e);a.addEventListener("error",g)})},snc=async function(a,b){const c=a.kn(a.cursor.request);a.cursor.continue(b);return c},unc=function(a){return new Promise((b,
c)=>{const d=H3("idb_transaction error");a.$B.addEventListener("complete",()=>b());a.$B.addEventListener("error",f=>{c(d(f.target?.error||a.$B.error||Error("Unknown error")))});const e=new tnc;a.$B.addEventListener("abort",()=>{if(a.$B.error instanceof Error){var f=e.cause=a.$B.error;f=[`${f.name}`,`${f.message}`].filter(g=>!!g).join(": ");e.message=`${e.message} (${f})`}c(e)})})},wnc=function(a){return a.name==="QuotaExceededError"||a instanceof DOMException&&a.code===22?!0:vnc.some(b=>b.test(a.message))},
ync=function(a){return!self.indexedDB||a instanceof tnc||a instanceof DOMException&&["AbortError","TransactionInactiveError"].includes(a.name)?!0:xnc.some(b=>b.test(a.message))},znc=async function({transaction:a,callback:b}){try{const c=await b(a);try{a?.commit?.()}catch{}return c}catch(c){try{a?.abort()}catch{}throw c;}},I3=async function(a,{hJ:b,mode:c,methodName:d},e){d=a.$a?.PAb({methodName:d});try{try{const g=nnc(await qnc(a.sZa,{},{wf:d}),b,c),[h]=await Promise.all([znc({transaction:g.transaction,
callback:e}),g.pfb]);return h}catch{const g=nnc(await qnc(a.sZa,{Hsb:!0},{wf:d}),b,c),[h]=await Promise.all([znc({transaction:g.transaction,callback:e}),g.pfb]);return h}}catch(g){const h=g instanceof Error?g:Error(String(g));var f=h instanceof Anc||h instanceof Bnc?h:wnc(h)?new Bnc(h):ync(h)?new Anc(h):h;f instanceof Cnc||f instanceof Dnc||f instanceof Enc||f instanceof Bnc||(d?.setAttribute("error",g instanceof Error?g.message:String(g)),d?.end("error"));throw f;}finally{d?.end("ok")}},Hnc=function({PAa:a,
$a:b}){return new Fnc(new Gnc(a,b),b!=null?{PAb:({methodName:c})=>{if(!(b==null||Math.random()>.01))return b.Qh(`storage_layer.idb_database_manager.execute.${c}`,{attrs:new Map([["sample_rate_override",1]]),timeout:3E5})}}:void 0)},Inc=async function(a){if(a.Dva!=null)switch(a=await a.Dva.getStatus(),a){case 1:case 2:break;case 3:case void 0:throw new Cnc;default:throw new __c.E(a);}},Jnc=function(a,b){return{key:a,record:b}},Knc=function(a){if(typeof a!=="object"||a==null)throw Error("Result is not an object");
a=a.key;if(typeof a!=="string")throw Error("Key is not a string");return a},J3=function(a){if(typeof a!=="object"||a==null)throw Error("Result is not an object");a=a.record;if(a==null)throw Error("Value is undefined");return a},Lnc=async function(a){try{return(0,__c.za)(await K3.open({name:a.yk,version:1,KDb:b=>{b=b.createObjectStore(a.yk,{keyPath:"key"});if(a.Pia!=null&&Object.keys(a.Pia).length>0)for(const [c,{hZb:d,...e}]of Object.entries(a.Pia))b.createIndex(c,`${"record"}.${d}`,e)},Kkb:{type:1,
bmb:!0,cmb:!0}},a.QZa))}catch(b){return(0,__c.Aa)(new Anc(b instanceof Error?b:Error(String(b))))}},Onc=function({yk:a,serializer:b,Dva:c,Pia:d={},$a:e,QZa:f}){return new Mnc(a,b,Hnc({PAa:new Nnc(a,d,f),$a:e}),c)},Pnc=function(){return Onc({yk:"config",serializer:{Fa:a=>a,za:a=>a}})},onc=class{static async open(a,b){a=await Lnc(a);if(!a.ok)throw a.error;const c=a.value,d=()=>{e.connection=void 0;c.removeEventListener("close",d)};c.addEventListener("close",d,{once:!0});const e=new onc({transaction:(f,
g)=>c.transaction(f,g),close:()=>{d();c.close();b()}});e.Bea=self.setTimeout(()=>{e.dispose()},2500);return e}get Sc(){return this.connection!=null}dispose(){this.connection?.close();this.connection=void 0;self.clearTimeout(this.Bea)}constructor(a){this.connection=a;this.fFa=0}};var Gnc=class{constructor(a,b){this.PAa=a;this.$a=b}};var Bnc=class extends Error{constructor(a){super("Quota exceeded");this.cause=a}},Cnc=class extends Error{constructor(){super("Consent required")}},Anc=class extends __c.zc{constructor(a){super("IndexedDb Database Error",0);this.cause=a}},Enc=class extends Error{constructor(){super("Maximum number of rows exceeded for put request")}},Dnc=class extends Error{constructor(a){super("Failed to deserialize stored data");this.cause=a}};var L3=class{async continue(a){a=await snc(this,a);if(a!=null)return new L3(a)}async update(a){a=this.cursor.update(a);return this.kn(a)}async delete(){const a=this.cursor.delete();return this.kn(a)}constructor(a){this.cursor=a;this.kn=rnc}},Qnc=class extends L3{async continue(a){a=await snc(this,a);if(a!=null)return new Qnc(a)}get value(){return this.cursor.value}constructor(a){super(a);this.cursor=a}};var Rnc=class{async get(a){a=this.index.get(a);return this.kn(a)}async getAll(a,b){a=this.index.getAll(a,b);return this.kn(a)}async getAllKeys(a,b){a=this.index.getAllKeys(a,b);return this.kn(a)}async count(a){a=this.index.count(a);return this.kn(a)}async openCursor(a,b){a=this.index.openCursor(a,b);a=await this.kn(a);return a!=null?new Qnc(a):void 0}async openKeyCursor(a,b){a=this.index.openKeyCursor(a,b);a=await this.kn(a);return a!=null?new L3(a):void 0}constructor(a){this.index=a;this.kn=rnc}};var Snc=class{index(a){return new Rnc(this.store.index(a))}async put(a,b){a=this.store.put(a,b);return this.kn(a)}async get(a){a=this.store.get(a);return this.kn(a)}async delete(a){a=this.store.delete(a);return this.kn(a)}async clear(){const a=this.store.clear();return this.kn(a)}async getAll(a,b){a=this.store.getAll(a,b);return this.kn(a)}async getAllKeys(a,b){a=this.store.getAllKeys(a,b);return this.kn(a)}async count(a){a=this.store.count(a);return this.kn(a)}async openCursor(a,b){a=this.store.openCursor(a,
b);a=await this.kn(a);return a!=null?new Qnc(a):void 0}async openKeyCursor(a,b){a=this.store.openKeyCursor(a,b);a=await this.kn(a);return a!=null?new L3(a):void 0}createIndex(a,b,c){return this.store.createIndex(a,b,c)}deleteIndex(a){return this.store.deleteIndex(a)}constructor(a){this.store=a;this.kn=rnc}};var Tnc=class{objectStore(a){a=this.$B.objectStore(a);return new Snc(a)}abort(){this.$B.abort()}commit(){this.$B.commit()}get error(){return this.$B.error}constructor(a){this.$B=a;this.fPb=unc(this)}},tnc=class extends Error{constructor(){super("Transaction was aborted")}};var vnc=[/Encountered full disk while opening backing store for indexedDB.open./i,/Failed to PutOrAdd in database because not enough space for domain/i],xnc=[/(transaction|operation) was aborted/i,/The database connection is closing/i,/connection to indexed database server lost/i,/internal error/i,/the transaction is inactive or finished/i,/unable to open database file on disk/i,/without an in-progress transaction/i,/The user denied permission to access the database\./];var Fnc=class{constructor(a,b){this.sZa=a;this.$a=b}};var Mnc=class{async put(a,b,c){await Inc(this);const d=Jnc(a,this.serializer.Fa(b));return I3(this.DH,{hJ:this.yk,mode:"readwrite",methodName:"put"},async e=>{e=e.objectStore(this.yk);const {rac:f}=c??{};if(f!=null){__c.u(f>0);const [g,h]=await Promise.all([e.get(a).then(k=>!!k),e.count()]);if(h+(g?0:1)>f)throw new Enc;}await e.put(d)})}async get(a){const b=await I3(this.DH,{hJ:this.yk,mode:"readonly",methodName:"get"},async c=>c.objectStore(this.yk).get(a));return b!=null?this.za(J3(b)):void 0}async delete(a){return I3(this.DH,
{hJ:this.yk,mode:"readwrite",methodName:"delete"},async b=>{const c=b.objectStore(this.yk);Array.isArray(a)?await Promise.all(a.map(d=>c.delete(d))):await c.delete(a)})}async count(){return I3(this.DH,{hJ:this.yk,mode:"readonly",methodName:"count"},async a=>a.objectStore(this.yk).count())}async update(a,b){await Inc(this);return I3(this.DH,{hJ:this.yk,mode:"readwrite",methodName:"update"},async c=>{c=c.objectStore(this.yk);var d=await c.get(a);d=d?{value:this.za(J3(d))}:void 0;d=b(d);d!=null?await c.put(Jnc(a,
this.serializer.Fa(d.value))):await c.delete(a)})}async updateAll(a,b,c){await Inc(this);return I3(this.DH,{hJ:this.yk,mode:"readwrite",methodName:"updateAll"},async d=>{const e=d.objectStore(this.yk);d=await (typeof c==="string"?e.index(c):e).getAll(b);await Promise.all(d.map(async f=>{const g=Knc(f);f=this.za(J3(f));f=a({value:f},g);f!=null?await e.put(Jnc(g,this.serializer.Fa(f.value))):await e.delete(g)}))})}async getAll(a,b){const c=await I3(this.DH,{hJ:this.yk,mode:"readonly",methodName:"getAll"},
async f=>{f=f.objectStore(this.yk);const g=typeof b==="string"?f.index(b):f;try{return(await g.getAll(a)).map(h=>(0,__c.za)(h))}catch{return f=await g.getAllKeys(a),Promise.all(f.map(async h=>{try{const k=await g.get(h);return(0,__c.za)(k)}catch(k){return(0,__c.Aa)({key:String(h),error:k instanceof Error?k:Error(String(k))})}}))}}),d=[],e=[];for(const f of c)if(f.ok)try{d.push({key:Knc(f.value),Qb:this.za(J3(f.value))})}catch(g){e.push({key:Knc(f.value),error:g instanceof Error?g:Error(String(g))})}else e.push({key:f.error.key,
error:f.error.error});return{items:d,errors:e}}async getAllKeys(){return I3(this.DH,{hJ:this.yk,mode:"readonly",methodName:"getAllKeys"},async a=>(await a.objectStore(this.yk).getAllKeys()).map(b=>String(b))||[])}async clear(){return I3(this.DH,{hJ:this.yk,mode:"readwrite",methodName:"clear"},async a=>a.objectStore(this.yk).clear())}close(){}za(a){try{return this.serializer.za(a)}catch(b){throw new Dnc(b instanceof Error?b:Error(String(b)));}}constructor(a,b,c,d){this.yk=a;this.serializer=b;this.DH=
c;this.Dva=d}};var K3=class{static open({name:a,version:b,KDb:c,Kkb:d},e=indexedDB){return new Promise((f,g)=>{try{const h=e.open(a,b);let k,l=!1;c&&h.addEventListener("upgradeneeded",n=>{l||(k=new K3(h.result),c(k,n))});switch(d.type){case 0:d.rCb&&h.addEventListener("blocked",d.rCb);h.addEventListener("success",()=>{f(k??new K3(h.result))});break;case 1:h.addEventListener("blocked",()=>{l=!0;g(Error("operation blocked due to open connections"))});h.addEventListener("success",()=>{const n=h.result;l?n.close():
(n.addEventListener("versionchange",p=>{(d.bmb&&p.newVersion==null||d.cmb&&p.newVersion!=null)&&n.close()}),f(k??new K3(n)))});break;default:throw new __c.E(d);}const m=H3("idb_database open error");h.addEventListener("error",()=>{g(m(h.error))})}catch(h){g(h)}})}transaction(a,b){return new Tnc(this.db.transaction(a,b))}createObjectStore(a,b){return new Snc(this.db.createObjectStore(a,b))}deleteObjectStore(a){this.db.deleteObjectStore(a)}get objectStoreNames(){return this.db.objectStoreNames}close(){this.db.close()}addEventListener(a,
b,c){this.db.addEventListener(a,b,c)}removeEventListener(a,b,c){this.db.removeEventListener(a,b,c)}static delete({name:a},b=indexedDB){return new Promise((c,d)=>{const e=H3("idb_database delete error"),f=b.deleteDatabase(a);f.addEventListener("blocked",()=>d(Error("operation blocked due to open connections")));f.addEventListener("error",()=>{d(e(f.error))});f.addEventListener("success",()=>c())})}constructor(a){this.db=a}};var Nnc=class{constructor(a,b,c){this.yk=a;this.Pia=b;this.QZa=c}};__c.Mba={f_b:async function(a){return Promise.race([(async()=>{try{return await Pnc().get("userAgent")}catch(b){a.Lb(b)}})(),__c.Jq(1E4).then(()=>{})])},WIb:async function(){await Pnc().put("userAgent",navigator.userAgent)}};
}).call(self, self._5f74ec40302898c5a55451c9fbd04240);}

}])
//# sourceMappingURL=sourcemaps/e8401ae5c544430e.js.map